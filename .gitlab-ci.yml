stages:
  - build
  - coverage

job 1:
  stage: build
  script:
  - scons
  - scons -c 
  - scan-build-3.9 --status-bugs scons --analyze

job 2:
  stage: coverage
  script:
  - export DISPLAY=:0
  - xhost +local:all
  - scons -Q --debug_build --unit --test --coverage
  - gcovr -f '.*/(Core/Source|AppFrameworks)'
  - bash <(curl -s https://codecov.io/bash) -t $CODECOV_REPO_TOKEN
  